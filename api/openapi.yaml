openapi: 3.0.3
info:
  description: "API REST para gestión de grupos, usuarios, contenido y simulacros"
  title: API oPROsita
  version: 1.0.2
servers:
- url: http://localhost:8080/api
tags:
- description: Operaciones con grupos de alumnos
  name: Grupo
- description: Gestión de alumnos
  name: Alumno
- description: Gestión de contenido educativo
  name: ContenidoItem
- description: Operaciones con simulacros de examen
  name: Simulacro
- description: Sistema de novedades y notificaciones
  name: Novedad
- description: Gestión de noticias
  name: Noticia
- description: Gestión de archivos y documentos
  name: Archivo
paths:
  /grupos:
    get:
      operationId: getGrupos
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Grupo'
                type: array
          description: Lista de grupos
        "500":
          description: Error interno
      summary: Obtener todos los grupos
      tags:
      - Grupo
      x-accepts:
      - application/json
    post:
      operationId: createGrupo
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Grupo'
        required: true
      responses:
        "201":
          description: Grupo creado
      summary: Crear un nuevo grupo
      tags:
      - Grupo
      x-content-type: application/json
      x-accepts:
      - application/json
  /grupos/{id}:
    delete:
      operationId: deleteGrupo
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Grupo eliminado correctamente
        "404":
          description: Grupo no encontrado
      summary: Eliminar un grupo
      tags:
      - Grupo
      x-accepts:
      - application/json
    get:
      operationId: getGrupoById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Grupo'
          description: Grupo encontrado
        "404":
          description: Grupo no encontrado
      summary: Obtener detalle de un grupo
      tags:
      - Grupo
      x-accepts:
      - application/json
    put:
      operationId: updateGrupo
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Grupo'
        required: true
      responses:
        "200":
          description: Grupo actualizado
      summary: Actualizar un grupo
      tags:
      - Grupo
      x-content-type: application/json
      x-accepts:
      - application/json
  /grupos/{grupoId}/alumnos:
    get:
      operationId: getAlumnosByGrupo
      parameters:
      - explode: false
        in: path
        name: grupoId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Lista de alumnos
      summary: Obtener alumnos de un grupo
      tags:
      - Grupo
      - Alumno
      x-accepts:
      - application/json
    post:
      operationId: addAlumnoToGrupo
      parameters:
      - explode: false
        in: path
        name: grupoId
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Alumno'
        required: true
      responses:
        "201":
          description: Alumno añadido
      summary: Añadir un alumno a un grupo
      tags:
      - Grupo
      - Alumno
      x-content-type: application/json
      x-accepts:
      - application/json
  /grupos/{grupoId}/alumnos/{alumnoId}:
    delete:
      operationId: removeAlumnoFromGrupo
      parameters:
      - explode: false
        in: path
        name: grupoId
        required: true
        schema:
          type: integer
        style: simple
      - explode: false
        in: path
        name: alumnoId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Alumno eliminado correctamente del grupo
      summary: Eliminar un alumno de un grupo
      tags:
      - Grupo
      - Alumno
      x-accepts:
      - application/json
  /alumnos/{id}:
    delete:
      operationId: deleteAlumno
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Alumno eliminado correctamente
      summary: Eliminar un alumno
      tags:
      - Alumno
      x-accepts:
      - application/json
  /alumnos/{alumnoId}/contenido:
    get:
      operationId: getContenidoByAlumno
      parameters:
      - explode: false
        in: path
        name: alumnoId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Lista de contenido
      summary: Obtener contenido de un alumno
      tags:
      - Alumno
      - ContenidoItem
      x-accepts:
      - application/json
    post:
      operationId: addContenidoToAlumno
      parameters:
      - explode: false
        in: path
        name: alumnoId
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/addContenidoToAlumno_request'
        required: true
      responses:
        "201":
          description: Contenido añadido
      summary: Añadir contenido al alumno (texto + tipo + PDF)
      tags:
      - Alumno
      - ContenidoItem
      x-content-type: multipart/form-data
      x-accepts:
      - application/json
  /alumnos/{alumnoId}/contenido/{contenidoId}:
    delete:
      operationId: deleteContenidoFromAlumno
      parameters:
      - explode: false
        in: path
        name: alumnoId
        required: true
        schema:
          type: integer
        style: simple
      - explode: false
        in: path
        name: contenidoId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Contenido eliminado correctamente
      summary: Eliminar un contenido del alumno
      tags:
      - Alumno
      - ContenidoItem
      x-accepts:
      - application/json
  /grupos/{grupoId}/meses/{mes}/contenido:
    get:
      operationId: getContenidoByGrupoAndMes
      parameters:
      - explode: false
        in: path
        name: grupoId
        required: true
        schema:
          type: integer
        style: simple
      - explode: false
        in: path
        name: mes
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/ContenidoItem'
                type: array
          description: Lista de contenido
      summary: Obtener contenido por grupo y mes
      tags:
      - Grupo
      - ContenidoItem
      x-accepts:
      - application/json
    post:
      operationId: addContenidoToGrupoByMes
      parameters:
      - explode: false
        in: path
        name: grupoId
        required: true
        schema:
          type: integer
        style: simple
      - explode: false
        in: path
        name: mes
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContenidoItem'
        required: true
      responses:
        "201":
          description: Contenido añadido
      summary: Añadir contenido a un grupo en un mes
      tags:
      - Grupo
      - ContenidoItem
      x-content-type: application/json
      x-accepts:
      - application/json
  /contenido/{id}:
    delete:
      operationId: deleteContenido
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Contenido eliminado correctamente
      summary: Eliminar un contenido
      tags:
      - ContenidoItem
      x-accepts:
      - application/json
    put:
      operationId: updateContenido
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContenidoItem'
        required: true
      responses:
        "200":
          description: Contenido actualizado
      summary: Actualizar un contenido
      tags:
      - ContenidoItem
      x-content-type: application/json
      x-accepts:
      - application/json
  /simulacros:
    get:
      operationId: getSimulacros
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Simulacro'
                type: array
          description: Lista de simulacros
      summary: Obtener simulacros
      tags:
      - Simulacro
      x-accepts:
      - application/json
    post:
      operationId: createSimulacro
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/createSimulacro_request'
        required: true
      responses:
        "201":
          description: Simulacro creado
      summary: Crear un nuevo simulacro (PDF + descripción)
      tags:
      - Simulacro
      x-content-type: multipart/form-data
      x-accepts:
      - application/json
  /simulacros/{id}:
    delete:
      operationId: deleteSimulacro
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Simulacro eliminado correctamente
      summary: Eliminar un simulacro
      tags:
      - Simulacro
      x-accepts:
      - application/json
  /novedades/profesor:
    get:
      operationId: getNovedadesProfesor
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Novedad'
                type: array
          description: Lista de novedades
      summary: Obtener novedades para profesores
      tags:
      - Novedad
      x-accepts:
      - application/json
    post:
      operationId: createNovedadProfesor
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Novedad'
        required: true
      responses:
        "201":
          description: Novedad creada
      summary: Crear novedad para profesores
      tags:
      - Novedad
      x-content-type: application/json
      x-accepts:
      - application/json
  /novedades/alumno:
    delete:
      operationId: deleteNovedadesAlumno
      responses:
        "204":
          description: Novedades eliminadas correctamente
      summary: Eliminar todas las novedades para alumno
      tags:
      - Novedad
      x-accepts:
      - application/json
    get:
      operationId: getNovedadesAlumno
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Novedad'
                type: array
          description: Lista de novedades
      summary: Obtener novedades para alumnos
      tags:
      - Novedad
      x-accepts:
      - application/json
    post:
      operationId: createNovedadAlumno
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Novedad'
        required: true
      responses:
        "201":
          description: Novedad creada
      summary: Crear novedad para alumnos
      tags:
      - Novedad
      x-content-type: application/json
      x-accepts:
      - application/json
    put:
      operationId: updateNovedadAlumno
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Novedad'
        required: true
      responses:
        "200":
          description: Novedad actualizada
      summary: Actualizar novedad para alumno
      tags:
      - Novedad
      x-content-type: application/json
      x-accepts:
      - application/json
  /novedades/{id}:
    delete:
      operationId: deleteNovedad
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Novedad eliminada correctamente
      summary: Eliminar una novedad
      tags:
      - Novedad
      x-accepts:
      - application/json
  /noticias:
    get:
      operationId: getNoticias
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/Noticia'
                type: array
          description: Lista de noticias
      summary: Obtener noticias
      tags:
      - Noticia
      x-accepts:
      - application/json
    post:
      operationId: createNoticia
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/createSimulacro_request'
        required: true
      responses:
        "201":
          description: Noticia creada
      summary: Crear una nueva noticia (PDF + descripción)
      tags:
      - Noticia
      x-content-type: multipart/form-data
      x-accepts:
      - application/json
  /noticias/{id}:
    delete:
      operationId: deleteNoticia
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "204":
          description: Noticia eliminada correctamente
      summary: Eliminar una noticia
      tags:
      - Noticia
      x-accepts:
      - application/json
  /archivos/upload:
    post:
      operationId: uploadArchivo
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/uploadArchivo_request'
        required: true
      responses:
        "201":
          description: Archivo subido correctamente
      summary: Subir archivo
      tags:
      - Archivo
      x-content-type: multipart/form-data
      x-accepts:
      - application/json
  /archivos/{id}/download:
    get:
      operationId: downloadArchivo
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/octet-stream:
              schema:
                format: binary
                type: string
          description: Archivo descargado
        "404":
          description: Archivo no encontrado
      summary: Descargar archivo por ID
      tags:
      - Archivo
      x-accepts:
      - application/octet-stream
components:
  schemas:
    Grupo:
      example:
        meses:
        - id: 6
          nombre: nombre
        - id: 6
          nombre: nombre
        id: 0
        nombre: nombre
      properties:
        id:
          type: integer
        nombre:
          type: string
        meses:
          items:
            $ref: '#/components/schemas/Mes'
          type: array
      type: object
      x-entity: true
    Mes:
      example:
        id: 6
        nombre: nombre
      properties:
        id:
          type: integer
        nombre:
          type: string
      type: object
      x-entity: true
    Usuario:
      discriminator:
        propertyName: tipo
      properties:
        id:
          type: integer
        nombre:
          type: string
        grupoId:
          type: integer
      type: object
      x-entity: true
    Alumno:
      allOf:
      - $ref: '#/components/schemas/Usuario'
      - properties:
          tipo:
            enum:
            - alumno
            type: string
        type: object
        x-entity: true
      example:
        tipo: alumno
        id: 0
        grupoId: 6
        nombre: nombre
    Profesor:
      allOf:
      - $ref: '#/components/schemas/Usuario'
      - properties:
          tipo:
            enum:
            - profesor
            type: string
        type: object
        x-entity: true
    ContenidoItem:
      example:
        texto: texto
        alumnoId: 6
        archivoId: 5
        tipoContenido: temas
        mes: mes
        id: 0
        grupoId: 1
      properties:
        id:
          type: integer
        texto:
          type: string
        tipoContenido:
          enum:
          - temas
          - programacion
          - practico
          type: string
        alumnoId:
          nullable: true
          type: integer
        grupoId:
          type: integer
        mes:
          type: string
        archivoId:
          nullable: true
          type: integer
      type: object
      x-entity: true
    Archivo:
      properties:
        id:
          type: integer
        nombre:
          type: string
        tipo:
          type: string
        url:
          type: string
        datos:
          format: byte
          type: string
      type: object
      x-entity: true
    Simulacro:
      example:
        descripcion: descripcion
        archivoId: 6
        id: 0
        grupoId: 1
      properties:
        id:
          type: integer
        descripcion:
          type: string
        archivoId:
          type: integer
        grupoId:
          type: integer
      type: object
      x-entity: true
    Novedad:
      example:
        texto: texto
        fechaCreacion: 2000-01-23T04:56:07.000+00:00
        id: 0
        tipoDestinatario: profesor
      properties:
        id:
          type: integer
        texto:
          type: string
        tipoDestinatario:
          enum:
          - profesor
          - alumno
          type: string
        fechaCreacion:
          format: date-time
          type: string
      type: object
      x-entity: true
    Noticia:
      example:
        descripcion: descripcion
        archivoId: 6
        id: 0
        grupoId: 1
      properties:
        id:
          type: integer
        descripcion:
          type: string
        archivoId:
          type: integer
        grupoId:
          type: integer
      type: object
      x-entity: true
    addContenidoToAlumno_request:
      properties:
        texto:
          type: string
        tipoContenido:
          enum:
          - temas
          - programacion
          - practico
          type: string
        mes:
          type: string
        file:
          format: binary
          type: string
      type: object
    createSimulacro_request:
      properties:
        descripcion:
          type: string
        grupoId:
          type: integer
        file:
          format: binary
          type: string
      type: object
    uploadArchivo_request:
      properties:
        file:
          format: binary
          type: string
      type: object

